<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mingxing&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/website/favicon.ico">
    <link rel="stylesheet" href="/website/css/override.css">
    <meta name="description" content="Vue-powered Static Site Generator">
    
    <link rel="preload" href="/website/assets/css/0.styles.2182f64e.css" as="style"><link rel="preload" href="/website/assets/js/app.9fa87afe.js" as="script"><link rel="preload" href="/website/assets/js/2.0dd9092c.js" as="script"><link rel="preload" href="/website/assets/js/1.59ce8ed3.js" as="script"><link rel="preload" href="/website/assets/js/30.eb64145a.js" as="script"><link rel="prefetch" href="/website/assets/js/10.a4af1cde.js"><link rel="prefetch" href="/website/assets/js/11.6db8ce1c.js"><link rel="prefetch" href="/website/assets/js/12.7498ae0a.js"><link rel="prefetch" href="/website/assets/js/13.99e02e00.js"><link rel="prefetch" href="/website/assets/js/14.684ca1e3.js"><link rel="prefetch" href="/website/assets/js/15.ca4572d8.js"><link rel="prefetch" href="/website/assets/js/16.7bd7da28.js"><link rel="prefetch" href="/website/assets/js/17.318d4455.js"><link rel="prefetch" href="/website/assets/js/18.87da4873.js"><link rel="prefetch" href="/website/assets/js/19.b80dbc2b.js"><link rel="prefetch" href="/website/assets/js/20.86180923.js"><link rel="prefetch" href="/website/assets/js/21.ea5ba088.js"><link rel="prefetch" href="/website/assets/js/22.6ef378f0.js"><link rel="prefetch" href="/website/assets/js/23.a29a2a16.js"><link rel="prefetch" href="/website/assets/js/24.ebdc384e.js"><link rel="prefetch" href="/website/assets/js/25.f66cf160.js"><link rel="prefetch" href="/website/assets/js/26.c23fe65f.js"><link rel="prefetch" href="/website/assets/js/27.9d9a2020.js"><link rel="prefetch" href="/website/assets/js/28.abe3357d.js"><link rel="prefetch" href="/website/assets/js/29.00c249f3.js"><link rel="prefetch" href="/website/assets/js/3.99ee007d.js"><link rel="prefetch" href="/website/assets/js/31.0a653b28.js"><link rel="prefetch" href="/website/assets/js/32.f129d412.js"><link rel="prefetch" href="/website/assets/js/33.fe6caade.js"><link rel="prefetch" href="/website/assets/js/34.ddde894f.js"><link rel="prefetch" href="/website/assets/js/35.004b72d1.js"><link rel="prefetch" href="/website/assets/js/36.70295b4c.js"><link rel="prefetch" href="/website/assets/js/37.ebd30a5c.js"><link rel="prefetch" href="/website/assets/js/38.fd89a9df.js"><link rel="prefetch" href="/website/assets/js/39.b419fc4d.js"><link rel="prefetch" href="/website/assets/js/4.d66f0a61.js"><link rel="prefetch" href="/website/assets/js/40.9d6c43c1.js"><link rel="prefetch" href="/website/assets/js/41.2cbb7065.js"><link rel="prefetch" href="/website/assets/js/42.cabefc57.js"><link rel="prefetch" href="/website/assets/js/43.901492f3.js"><link rel="prefetch" href="/website/assets/js/5.07668c18.js"><link rel="prefetch" href="/website/assets/js/6.299ec846.js"><link rel="prefetch" href="/website/assets/js/7.ef178c10.js"><link rel="prefetch" href="/website/assets/js/vendors~docsearch.271bc088.js">
    <link rel="stylesheet" href="/website/assets/css/0.styles.2182f64e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/website/" class="home-link router-link-active"><img src="/website/logo.png" alt="Mingxing's blog" class="logo"> <span class="site-name can-hide">Mingxing's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/website/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/website/fun.html" class="nav-link">
  Funny tools
</a></div><div class="nav-item"><a href="https://github.com/ShiXingXinYa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/website/redis/cluster.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/website/zh-CN/redis/cluster.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/website/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/website/fun.html" class="nav-link">
  Funny tools
</a></div><div class="nav-item"><a href="https://github.com/ShiXingXinYa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/website/redis/cluster.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/website/zh-CN/redis/cluster.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/website/docker/" class="sidebar-link">Windows case</a></li><li><a href="/website/docker/compose.html" class="sidebar-link">docker-compose case</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/website/redis/" aria-current="page" class="sidebar-link">Redis Introduction</a></li><li><a href="/website/redis/cluster.html" aria-current="page" class="active sidebar-link">Redis Cluster</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#目录" class="sidebar-link">目录</a></li><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#安装redis-ruby" class="sidebar-link">安装redis/Ruby</a></li><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#redis主从复制" class="sidebar-link">redis主从复制</a></li><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#注册redis服务" class="sidebar-link">注册redis服务</a></li><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#搭建哨兵集群" class="sidebar-link">搭建哨兵集群</a></li><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#cluster集群" class="sidebar-link">cluster集群</a></li><li class="sidebar-sub-header"><a href="/website/redis/cluster.html#搭建过程中遇到的问题" class="sidebar-link">搭建过程中遇到的问题</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Web</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/website/zh-CN/web/uniapp-h5.html" class="sidebar-link">媒体查询解决uniapp-构建H5在浏览器打开后宽度100%的问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>PHP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Phpoffice</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/website/php/phpoffice/export.html" class="sidebar-link">Export</a></li><li><a href="/website/php/phpoffice/import.html" class="sidebar-link">Import</a></li><li><a href="/website/php/phpoffice/exception.html" class="sidebar-link">Abnormal issues and solutions</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="custom-block tip"><p class="custom-block-title">TIP</p> <h3 id="本篇-windows10本地注册redis多服务构建redis集群"><a href="#本篇-windows10本地注册redis多服务构建redis集群" class="header-anchor">#</a> 本篇：windows10本地注册Redis多服务构建Redis集群</h3></div> <h2 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h2> <ol><li><p><a href="#%E5%AE%89%E8%A3%85redis/Ruby">安装Redis/Ruby</a></p></li> <li><p><a href="#redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">Redis主从复制</a></p> <ol><li><a href="#%E5%87%86%E5%A4%87%E5%AE%9E%E4%BE%8B%E5%92%8C%E9%85%8D%E7%BD%AE">准备实例和配置</a></li> <li><a href="#%E5%90%AF%E5%8A%A8%E5%8F%8A%E6%B5%8B%E8%AF%95">启动及测试</a></li></ol></li> <li><p><a href="#%E6%B3%A8%E5%86%8Credis%E6%9C%8D%E5%8A%A1">注册redis服务</a></p></li> <li><p><a href="#%E6%90%AD%E5%BB%BA%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4">搭建哨兵集群</a></p> <ol><li><a href="#%E5%87%86%E5%A4%87%E5%AE%9E%E4%BE%8B%E5%92%8C%E9%85%8D%E7%BD%AE">准备哨兵实例和配置</a></li> <li><a href="#%E5%93%A8%E5%85%B5%E5%90%AF%E5%8A%A8%E5%8F%8A%E6%B5%8B%E8%AF%95">哨兵启动及测试</a></li></ol></li> <li><p><a href="#cluster%E9%9B%86%E7%BE%A4">Cluster集群</a></p> <ol><li><a href="#%E5%87%86%E5%A4%87cluster%E5%AE%9E%E4%BE%8B%E5%92%8C%E9%85%8D%E7%BD%AE">准备Cluster实例和配置</a></li> <li><a href="#cluster%E9%9B%86%E7%BE%A4%E5%90%AF%E5%8A%A8%E5%8F%8A%E6%B5%8B%E8%AF%95">Cluster启动及测试</a></li></ol></li> <li><p><a href="#%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91">搭建过程中遇到的坑</a></p></li></ol> <h2 id="安装redis-ruby"><a href="#安装redis-ruby" class="header-anchor">#</a> 安装redis/Ruby</h2> <ul><li><p>为什么要安装Ruby？</p> <p>Redis有一个称为Redis Cluster的功能，它允许将多个Redis节点组合成一个分布式系统。Ruby在这里的角色主要是通过Redis客户端库来与Redis集群进行通信和操作数据。</p> <p><a href="https://rubyinstaller.org/downloads/" target="_blank" rel="noopener noreferrer">Ruby下载地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>安装Redis：windows下官方提供了3.0版本，这里我们使用【tporadowski】的5.0版本</p> <p><a href="https://github.com/MicrosoftArchive/redis/releases?page=1" target="_blank" rel="noopener noreferrer">官方Redis下载地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/tporadowski/redis/releases" target="_blank" rel="noopener noreferrer">Redis for Windows 5.0.14.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <p>redis文件结构：</p> <p><img src="/website/redis/1720497691777.jpg" alt="redis结构"></p> <p><font color="red">注：redis 3.0版本及以上才支持集群</font></p> <h2 id="redis主从复制"><a href="#redis主从复制" class="header-anchor">#</a> redis主从复制</h2> <h3 id="准备实例和配置"><a href="#准备实例和配置" class="header-anchor">#</a> 准备实例和配置</h3> <ul><li><p>主节点配置文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#主节点配置文件内容
# 设置Redis端口号，默认是6379
port 6000 #端口可自定义
bind 127.0.0.1
daemonize yes
#日志记录
logfile &quot;./redis-master-slave/redis-master-6000.log&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>从节点配置文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>port 6001 #端口可自定义
bind 127.0.0.1
daemonize yes
replica-read-only yes # 从节点是否只读，yes表示只读，no表示可读写
# 开启主从复制
slaveof 127.0.0.1 6000
#日志记录
logfile &quot;./redis-master-slave/redis-slave-6001.log&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="创建多个从节点可复制上述从节点配置内容并更改不同的端口号。"><a href="#创建多个从节点可复制上述从节点配置内容并更改不同的端口号。" class="header-anchor">#</a> 创建多个从节点可复制上述从节点配置内容并更改不同的端口号。</h3></li></ul> <h3 id="启动及测试"><a href="#启动及测试" class="header-anchor">#</a> 启动及测试</h3> <p>启动命令：redis-server.exe 配置文件地址 --loglevel 日志级别</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#启动主节点命令
redis-server.exe ./redis-master-slave/redis-master-6000.conf --loglevel verbose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>#启动从节点命令
redis-server.exe ./redis-master-slave/redis-master-6000.conf --loglevel verbose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>文件目录：</p> <p><img src="/website/redis/1720497424016.jpg" alt="redis主从文件目录"></p> <p>在目录Redis-x64-5.0.14.1下进入cmd执行上述命令，内容如下：</p> <p><img src="/website/redis/1720495935976.jpg" alt="redis主从启动"></p> <p><img src="/website/redis/1720496115196.jpg" alt="redis主从启动"></p> <p>至此主从复制也就配置成功了。</p> <h2 id="注册redis服务"><a href="#注册redis服务" class="header-anchor">#</a> 注册redis服务</h2> <p>为了方便，注册redis服务。</p> <p>注册命令：redis-server.exe --service-install  配置文件地址 --service-name 服务名称 --loglevel 日志级别</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#注册主节点6000服务
redis-server.exe --service-install ./redis-master-slave/redis-master-6000.conf --service-name redis-master-6000 --loglevel verbose

#注册从节点6001服务
redis-server.exe --service-install ./redis-master-slave/redis-slave-6001.conf --service-name redis-master-6001 --loglevel verbose

#注册从节点6002服务
redis-server.exe --service-install ./redis-master-slave/redis-slave-6002.conf --service-name redis-master-6002 --loglevel verbose


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注册成功，打开windows服务管理，查看redis服务,可手动启动/停止服务</p> <p><img src="/website/redis/1720507725365.jpg" alt="'redis服务注册'"></p> <p>cmd打开执行redis-cli.exe -h 127.0.0.1 -p 6000即可启动redis主节点服务（注：需要将redis安装目录放入系统变量）</p> <p><img src="/website/redis/1720507945436.jpg" alt="'redis服务'"></p> <h2 id="搭建哨兵集群"><a href="#搭建哨兵集群" class="header-anchor">#</a> 搭建哨兵集群</h2> <p>哨兵集群的搭建和主从复制类似，但是哨兵集群需要新增配置文件。</p> <h3 id="准备实例和配置-2"><a href="#准备实例和配置-2" class="header-anchor">#</a> 准备实例和配置</h3> <ul><li><p>哨兵1配置文件:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 哨兵sentinel实例运行的端口
port 26378
# 本地ip
bind 127.0.0.1
#已守护进程运行
daemonize yes
#防止通过Sentinel动态地更改脚本
sentinel deny-scripts-reconfig yes
# 哨兵监听的主服务器 后面的2表示主机挂掉以后进行投票，只需要2票就可以从机变主机
sentinel monitor mymaster 127.0.0.1 6000 2
# 设置未得到主机响应时间，此处代表5秒未响应视为宕机
sentinel down-after-milliseconds mymaster 5000
# 设置等待主机活动时间，此处代表15秒主机未活动，则重新选举主机
sentinel failover-timeout mymaster 15000
# 设置重新选举主机后，同一时间同步数据的从机数量，此处代表重新选举主机后，每次2台从机同步主机数据，直到所有从机同步结束
sentinel config-epoch mymaster 2
# 执行故障转移时， 最多有2个从服务器同时对新的主服务器进行同步
sentinel leader-epoch mymaster 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p>哨兵2配置文件:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 哨兵sentinel实例运行的端口
port 26379
# 本地ip
bind 127.0.0.1
#已守护进程运行
daemonize yes
#防止通过Sentinel动态地更改脚本
sentinel deny-scripts-reconfig yes
# 哨兵监听的主服务器 后面的2表示主机挂掉以后进行投票，只需要2票就可以从机变主机
sentinel monitor mymaster 127.0.0.1 6001 2
# 其他内容复制哨兵1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>哨兵3配置文件:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 哨兵sentinel实例运行的端口
port 26380
# 本地ip
bind 127.0.0.1
#已守护进程运行
daemonize yes
#防止通过Sentinel动态地更改脚本
sentinel deny-scripts-reconfig yes
# 哨兵监听的主服务器 后面的2表示主机挂掉以后进行投票，只需要2票就可以从机变主机
sentinel monitor mymaster 127.0.0.1 6002 2
# 其他内容复制哨兵1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <h3 id="哨兵启动及测试"><a href="#哨兵启动及测试" class="header-anchor">#</a> 哨兵启动及测试</h3> <p>启动命令：redis-server.exe 哨兵配置文件路径 --sentinel</p> <p>启动成功如下：</p> <p><img src="/website/redis/1720508756137.jpg" alt="'redis哨兵测试图'"></p> <p>当然，你也可以将哨兵注册成服务,注册命令： redis-server.exe --service-install 哨兵配置文件路径 --service-name 服务名称 --sentinel</p> <h2 id="cluster集群"><a href="#cluster集群" class="header-anchor">#</a> cluster集群</h2> <p>Cluster配置文件目录：
<img src="/website/redis/1720511641368.jpg" alt="'redis Cluster配置文件'"></p> <h3 id="准备cluster实例和配置"><a href="#准备cluster实例和配置" class="header-anchor">#</a> 准备cluster实例和配置</h3> <ul><li><p>redis-7001.conf配置文件:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#实例运行的端口
port 7001
cluster-enabled yes
cluster-config-file nodes-7001.conf
cluster-node-timeout 5000
appendonly yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>#注册cluster节点7001服务
redis-server.exe --service-install ./redis-cluster/redis-7001.conf --service-name redis-cluster-7001 --loglevel verbose

#注册cluster节点7002服务
redis-server.exe --service-install ./redis-cluster/redis-7002.conf --service-name redis-cluster-7002 --loglevel verbose

#注册其他cluster节点参考上述7001和7002
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <p>注册好redis后查看服务，内容如下：</p> <p><img src="/website/redis/1720514742099.jpg" alt="'redis-cluster服务'"></p> <ul><li>redis服务注册后，需手动启动服务</li></ul> <h3 id="cluster集群启动及测试"><a href="#cluster集群启动及测试" class="header-anchor">#</a> cluster集群启动及测试</h3> <p>启动服务：</p> <p><img src="/website/redis/1720514742099.jpg" alt="'redis-cluster服务'"></p> <p>待完善中...</p> <h2 id="搭建过程中遇到的问题"><a href="#搭建过程中遇到的问题" class="header-anchor">#</a> 搭建过程中遇到的问题</h2> <ul><li>使用redis3.0版本在启动主从复制时，遇到报错：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>Invalid argument during startup: unknown conf file parameter : replicaof
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>原因：Redis 版本过旧，不支持replicaof参数。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/website/redis/" class="prev router-link-active">
        Redis Introduction
      </a></span> <span class="next"><a href="/website/zh-CN/web/uniapp-h5.html">
        媒体查询解决uniapp-构建H5在浏览器打开后宽度100%的问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/website/assets/js/app.9fa87afe.js" defer></script><script src="/website/assets/js/2.0dd9092c.js" defer></script><script src="/website/assets/js/1.59ce8ed3.js" defer></script><script src="/website/assets/js/30.eb64145a.js" defer></script>
  </body>
</html>
